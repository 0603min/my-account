<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 é›²ç«¯è¨˜å¸³æœ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background: #f0f2f5; }
        .glass-ui { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        .loading { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.7); z-index: 100; justify-content: center; align-items: center; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div id="loader" class="loading font-bold text-indigo-600">åŒæ­¥é›²ç«¯è³‡æ–™ä¸­...</div>

    <div class="max-w-lg mx-auto">
        <header class="flex justify-between items-center mb-6">
            <h1 class="text-2xl font-bold text-gray-800">2026 é›²ç«¯å¸³æœ¬</h1>
            <button onclick="fetchData()" class="text-indigo-600 text-sm font-medium">ğŸ”„ åˆ·æ–°</button>
        </header>

        <div class="glass-ui p-6 mb-6 grid grid-cols-2 gap-4">
            <div class="col-span-2 text-center pb-4 border-b border-gray-100">
                <p class="text-gray-400 text-sm">ç•¶å‰ç¸½é¤˜é¡</p>
                <h2 id="balance" class="text-4xl font-bold text-gray-800">$ 0</h2>
            </div>
            <div class="text-center">
                <p class="text-green-500 text-xs font-bold">ç¸½å­˜å…¥</p>
                <p id="income" class="text-lg text-gray-700 font-semibold">$ 0</p>
            </div>
            <div class="text-center">
                <p class="text-red-500 text-xs font-bold">ç¸½æ”¯å‡º</p>
                <p id="expense" class="text-lg text-gray-700 font-semibold">$ 0</p>
            </div>
        </div>

        <div class="glass-ui p-6 mb-8">
            <input id="desc" type="text" placeholder="é …ç›®å…§å®¹" class="w-full mb-3 p-3 bg-gray-50 border-none rounded-xl outline-none focus:ring-2 ring-indigo-400">
            <input id="amount" type="number" placeholder="é‡‘é¡" class="w-full mb-4 p-3 bg-gray-50 border-none rounded-xl outline-none focus:ring-2 ring-indigo-400">
            <div class="flex gap-3">
                <button onclick="sendData('income')" class="flex-1 bg-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg shadow-indigo-200">å­˜å…¥</button>
                <button onclick="sendData('expense')" class="flex-1 bg-gray-800 text-white py-3 rounded-xl font-bold">æ”¯å‡º</button>
            </div>
        </div>

        <h3 class="font-bold text-gray-700 mb-4 px-2">æœ€è¿‘äº¤æ˜“ (åŒæ­¥è‡³é›²ç«¯)</h3>
        <div id="list" class="space-y-3"></div>
    </div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbyrpe7TTYrmK1SL0ar8UDyiuB4nBgA8Y_3-PqzJBVjHz4rFvqEi2rG0b6VERliDfpmbgw/exec'; // 

        // åˆå§‹åŒ–ï¼šå¾é›²ç«¯æŠ“è³‡æ–™
        window.onload = fetchData;

        async function fetchData() {
            showLoader(true);
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                render(data);
            } catch (e) {
                alert("æŠ“å–è³‡æ–™å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²å€æˆ–æ¬Šé™è¨­å®š");
            }
            showLoader(false);
        }

        async function sendData(type) {
            const desc = document.getElementById('desc').value;
            const amount = parseFloat(document.getElementById('amount').value);

            if (!desc || isNaN(amount)) return alert("è«‹è¼¸å…¥å®Œæ•´è³‡æ–™");

            showLoader(true);
            try {
                await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ desc, amount, type })
                });
                document.getElementById('desc').value = '';
                document.getElementById('amount').value = '';
                await fetchData(); // é‡æ–°æŠ“å–æœ€æ–°è³‡æ–™
            } catch (e) {
                alert("å„²å­˜å¤±æ•—");
            }
            showLoader(false);
        }

        function render(data) {
            const list = document.getElementById('list');
            const balEl = document.getElementById('balance');
            const incEl = document.getElementById('income');
            const expEl = document.getElementById('expense');

            let bal = 0, inc = 0, exp = 0;
            list.innerHTML = '';

            data.reverse().forEach(item => {
                const amt = parseFloat(item.amount);
                if (item.type === 'income') { inc += amt; bal += amt; }
                else { exp += amt; bal -= amt; }

                const div = document.createElement('div');
                div.className = 'glass-ui p-4 flex justify-between items-center';
                div.innerHTML = `
                    <div>
                        <p class="font-bold text-gray-800">${item.desc}</p>
                        <p class="text-[10px] text-gray-400">${new Date(item.date).toLocaleDateString()}</p>
                    </div>
                    <span class="font-bold ${item.type === 'income' ? 'text-green-500' : 'text-red-500'}">
                        ${item.type === 'income' ? '+' : '-'}$ ${amt.toLocaleString()}
                    </span>
                `;
                list.appendChild(div);
            });

            balEl.innerText = `$ ${bal.toLocaleString()}`;
            incEl.innerText = `$ ${inc.toLocaleString()}`;
            expEl.innerText = `$ ${exp.toLocaleString()}`;
        }

        function showLoader(show) {
            document.getElementById('loader').style.display = show ? 'flex' : 'none';
        }
    </script>
</body>
</html>